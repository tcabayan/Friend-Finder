<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Friend Finder</title>
	
		<!-- Including Font Awesome Icons -->
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css"/>
	
		<!-- Link to reset stylesheet -->
		<link rel="stylesheet" href="css/reset.css">
	
		<!--Import Google Icon Font-->
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		
		<!-- Bootstrap CSS -->
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
			  
		<link rel="stylesheet" href="css/style.css">
	
	</head>

	<main>
		<header>
			<!--NavBar Beginning-->
			<nav class="navbar navbar-expand-lg friend-nav">
				<a class="navbar-brand" href="/home"><i class="fas fa-address-book"></i> Friend Finder</a>
				
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarNav">
				  <ul class="navbar-nav">
					<li class="nav-item active">
					  <a class="nav-link" href="/survey">Survey <span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item">
					  <a class="nav-link" href="/api/friends">API Friends List</a>
					</li>
					<li class="nav-item">
					  <a class="nav-link" href="https://github.com/tcabayan/Friend-Finder">GitHub Repo</a>
					</li>
				  </ul>
				</div>
			  </nav>
			<!--NavBar End-->
		</header>

		<div class="container">
			<form class="mainpanel-content"> 
				<div class=form-header>
					<h1>Survey Questions</h1>
					<h3>About You</h3>
				</div>
				<div class="form-group">	
					<label for="name"><h5><i class="fas fa-users"></i> Name (Required)</h5></label>
					<input type="text" class="validate" id="userName" placeholder="Your Name Here">
				</div>
				<div class="form-group">	
					<label for="photo"><h5><i class="fas fa-portrait"></i> Link to Photo Image (Required)</h5></label>
					<input type="text" class="validate" id="userPhoto" placeholder="Photo Link Here">
				</div>
				<!-- Survey Questions -->
				<!--Question 1-->
				<div class="form-group">
					<label for="question1"><h3>Question 1</h3></label>
					<h5 id="prompt1" class="form-text"> Your mind is always buzzing with unexplored ideas and plans.</h5>
					<select class="form-control" id="question1">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 2-->
				<div class="form-group">
					<label for="question2"><h3>Question 2</h3></label>
					<h5 id="prompt2" class="form-text"><h5>Generally speaking, you rely more on your experience than your imagination.</h5>
					<select class="form-control" id="question2">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 3-->
				<div class="form-group">
					<label for="question3"><h3>Question 3</h3></label>
					<h5 id="prompt3" class="form-text"><h5>You find it easy to stay relaxed and focused even when there is some pressure.</h5>
					<select class="form-control" id="question3">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 4-->
				<div class="form-group">
					<label for="question4"><h3>Question 4</h3></label>
					<h5 id="prompt4" class="form-text"><h5>You rarely do something just out of sheer curiosity.</h5>
					<select class="form-control" id="question4">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 5-->
				<div class="form-group">
					<label for="question5"><h3>Question 5</h3></label>
					<h5 id="prompt5" class="form-text"><h5>People can rarely upset you.</h5>
					<select class="form-control" id="question5">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 6-->
				<div class="form-group">
					<label for="question6"><h3>Question 6</h3></label>
					<h5 id="prompt6" class="form-text"><h5>It is often difficult for you to relate to other people’s feelings.</h5>
					<select class="form-control" id="question6">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 7-->
				<div class="form-group">
					<label for="question7"><h3>Question 7</h3></label>
					<h5 id="prompt7" class="form-text"><h5>In a discussion, truth should be more important than people’s sensitivities.</h5>
					<select class="form-control" id="question7">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 8-->
				<div class="form-group">
					<label for="question8"><h3>Question 8</h3></label>
					<h5 id="prompt8" class="form-text"><h5>You rarely get carried away by fantasies and ideas.</h5>
					<select class="form-control" id="question8">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 9-->
				<div class="form-group">
					<label for="question9"><h3>Question 9</h3></label>
					<h5 id="prompt9" class="form-text"><h5>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h5>
					<select class="form-control" id="question8">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!--Question 10-->
				<div class="form-group">
					<label for="question9"><h3>Question 10</h3></label>
					<h5 id="prompt10" class="form-text"><h5>You feel more energetic after spending time with a group of people.</h5>
					<select class="form-control" id="question10">
						<option value="" disabled selected>Choose your option</option>
						<option value="1">1 (Strongly Disagree)</option>
						<option value="2"> 2</option>
						<option value="3">3</option>
						<option value="4">4</option>
						<option value="5">5 (Strongly Agree)</option>
					</select>
				</div>
				<!-- Survey Submit Button -->
				<div>
					<button class="btn waves-effect waves-light" type="submit" name="action" id="submitButton">Submit Responses
						<i class="material-icons right">send</i>
					</button>
				</div>
			</form>
		</div>
	</main>

	<footer class="page-footer">
		<div class="footer-copyright text-center">
			<div class="container">
				© 2020 Cabayan Incorporated
			</div>
		</div>
	</footer>

	<!-- Modal Dialog Displaying Closest Friend Match -->
	<div id="modal1" class="modal">
		<div class="modal-content">
			<h4>Closest Friend Match</h4>
			<div class="divider"></div>
			<h5 id="userMatch"></h5>
			<img id="userMatchImage" class="materialboxed" width="650" src="">
		</div>
		<div class="modal-footer">
			<a href="/survey" class="modal-action modal-close waves-effect waves-green btn-flat">Fill Again!</a>
		</div>
	</div>

	<!-- Modal -->
    <div id="resultsModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title"><strong>Best Match</strong></h2>
                </div>
                <div class="modal-body">
                    <h2 id="userMatch"></h2>
                    <img id="userMatchImage" src="https://via.placeholder.com/400x400" alt="Placeholder image in case user pic doesn't show">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
	</div>
	<script
	  src="https://code.jquery.com/jquery-3.2.1.min.js"
	  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
	  crossorigin="anonymous"></script>
    <script type="text/javascript" src="./app.js"></script>	
</body>
</html>

<script type="text/javascript">
	$("#submitBtn").on("click", function(event) {
		event.preventDefault();

		//Form Validation
		var valid = true;
		if($("#userName").val === "" || $("#userPhoto").val === "" ){
			valid = false;
		} else if($("question1").val()==="empty" || $("question2").val()==="empty" || $("question3").val()==="empty" || $("question4").val()==="empty" || $("question5").val()==="empty" || $("question6").val()==="empty" || $("question7").val()==="empty" || $("question8").val()==="empty" || $("question9").val()==="empty" || $("question10").val()==="empty") {
			valid = false;
		}

		if(valid === true) {
		var newUser = {
			name: $("#userName").val().trim(),
			photo: $("#userPhoto").val().trim(),
			scores: [
				$("#question1").val(),
				$("#question2").val(),
				$("#question3").val(),
				$("#question4").val(),
				$("#question5").val(),
				$("#question6").val(),
				$("#question7").val(),
				$("#question8").val(),
				$("#question9").val(),
				$("#question10").val()
			]
		};

		var currentURL = window.location.origin;

		$.post(currentURL + "/api/friends", newUser, function(data) {
				$("#bestFriend").text(data.name);
				$("#bestFriendPhoto").attr("src", data.photo);
				$("#bestFriendModal").modal("toggle");
			});

		$.post(currentURL + "/api/friends", newUser, (function(data) {
			$("#userMatch").text(data.matchName);
			$("#userMatchImage").attr("src", data.matchImage);
			$("#resultsModal").modal("toggle");
			});
		} else {
			// If a required field is missing, show alert
			alert("Survey is incomplete!")
		}
	});
</script>
