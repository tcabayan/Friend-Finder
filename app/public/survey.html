<!DOCTYPE html>
<html>
<head>
	<title>Survey - Friend Finder</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">

	<!-- Including Font Awesome Icons -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css"/>
	
	<!-- Link to reset stylesheet -->
	<link rel="stylesheet" href="css/reset.css">

	<!--Import Google Icon Font-->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	
	<!--Link to Static CSS-->
	<link rel="stylesheet" href="css/style.css">

</head>
<body>
	<header>
		<!--NavBar Beginning-->
		<nav class="navbar navbar-expand-lg friend-nav">
			<a class="navbar-brand" href="/home"><i class="fas fa-address-book"></i> Friend Finder</a>
			
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			  <span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
			  <ul class="navbar-nav">
				<li class="nav-item active">
				  <a class="nav-link" href="/survey">Survey <span class="sr-only">(current)</span></a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="/api/friends">API Friends List</a>
				</li>
				<li class="nav-item">
				  <a class="nav-link" href="https://github.com/tcabayan/Friend-Finder">GitHub Repo</a>
				</li>
			  </ul>
			</div>
		  </nav>
		<!--NavBar End-->
	</header>
	<div class="container content">
		<h1>Survey</h1>
		<p>Take a quick survey to find your perfect match! These questions are answered by the numbers 1 through 5. If you really, really disagree with the statement, your answer would be 1. If you find a statement to hit extremely close to home, put in a 5.</p>
		<form>
			<div class="form-group">
				<label for="name"><h5><i class="fas fa-users"></i> Name (Required)</h5></label>
				<input id="name" type="text" class="form-control" placeholder="Name (Required)">
			</div>
			<div class="form-group">
				<label for="photo"><h5><i class="fas fa-portrait"></i> Link to Photo Image (Required)</h5></label>
				<input id="photo" type="text" class="form-control" placeholder="Link to Profile Photo (Required)">
			</div>
			<!-- Survey Questions -->
			<!--Question 1-->
			<div class="form-group">
				<label for="question1"><h5>Question 1: Your mind is always buzzing with unexplored ideas and plans.</h5></label>
				<select class="form-control" id="question1">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 2-->
			<div class="form-group">
				<label for="question2"><h5>Question 2: Generally speaking, you rely more on your experience than your imagination.</h5></label>
				<select class="form-control" id="question2">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 3-->
			<div class="form-group">
				<label for="question3"><h5>Question 3: You find it easy to stay relaxed and focused even when there is some pressure.</h5></label>
				<select class="form-control" id="question3">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 4-->
			<div class="form-group">
				<label for="question4"><h5>Question 4: You rarely do something just out of sheer curiosity.</h5></label>
				<select class="form-control" id="question4">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 5-->
			<div class="form-group">
				<label for="question5"><h5>Question 5: People can rarely upset you.</h5></label>
				<select class="form-control" id="question5">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 6-->
			<div class="form-group">
				<label for="question6"><h5>Question 6: It is often difficult for you to relate to other people’s feelings.</h5></label>
				<select class="form-control" id="question6">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 7-->
			<div class="form-group">
				<label for="question7"><h5>Question 7: In a discussion, truth should be more important than people’s sensitivities.</h5></label>
				<select class="form-control" id="question7">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 8-->
			<div class="form-group">
				<label for="question8"><h5>Question 8: You rarely get carried away by fantasies and ideas.</h5></label>
				<select class="form-control" id="question8">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 9-->
			<div class="form-group">
				<label for="question9"><h5>Question 9: You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h5></label>
				<select class="form-control" id="question9">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
			<!--Question 10-->
			<div class="form-group">
				<label for="question10"><h5>Question 10: You feel more energetic after spending time with a group of people.</h5></label>
				<select class="form-control" id="question10">
					<option value="empty"></option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
			</div>
		</form>
		<div class="text-center">
			<button id="submitBtn" type="submit" class="btn btn-lg" data-toggle="modal" data-target="#resultsModal"> Submit</button>
		</div>
		
		<!-- Modal after survey completion -->
		<div id="resultsModal" class="modal fade" role="dialog">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h3 class="modal-title">Your Match</h1>
					</div>
					<div class="modal-body">
						<h2 id="friendMatch"></h2>
						<img id="friendPhoto" src="#">
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal" data-toggle="modal" data-target="#resultsModal">Close</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<footer class="page-footer">
		<div class="footer-copyright text-center">
			<div class="container">
				© 2020 Cabayan Incorporated
			</div>
		</div>
	</footer>

	<script src="https://code.jquery.com/jquery-3.2.1.min.js" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>
</html>

<script type="text/javascript">
	$("#submitBtn").on("click", function(event) {
		event.preventDefault();

		// Form validation
		var valid = true;

		if($("#name").val() === "" || $("#photo").val() === "") {
			valid = false;
		} else if($("#question1").val() === "empty" || $("#question2").val() === "empty" || $("#question3").val() === "empty" || $("#question4").val() === "empty" || $("#question5").val() === "empty" || $("#question6").val() === "empty" || $("#question7").val() === "empty" || $("#question8").val() === "empty" || $("#question9").val() === "empty" || $("#question10").val() === "empty") {
			valid = false;
		}

		if(valid === true) {
			var newUser = {
				name: $("#name").val().trim(),
				photo: $("#photo").val().trim(),
				scores: [
					$("#question1").val(),
					$("#question2").val(),
					$("#question3").val(),
					$("#question4").val(),
					$("#question5").val(),
					$("#question6").val(),
					$("#question7").val(),
					$("#question8").val(),
					$("#question9").val(),
					$("#question10").val()
				]
			};

			var currentURL = window.location.origin;

			// Ajax call for receiving response after POST req
			$.post(currentURL + "/api/friends", newUser, function(data) {
				console.log(data);
				$("#resultsModal").modal();
				$("#friendMatch").text(data.matchName);
				$("#friendPhoto").attr("src", data.matchImage);
				$("#resultsModal").modal("toggle");
			});
		} else {
			// If a required field is missing, show alert
			alert("Survey is incomplete!");
		}
	});
</script>